# 服务器性能监控方法

## 概述

本文档介绍如何搭建和使用服务器性能监控系统。

## 监控指标

### CPU指标
- 使用率（%）
- 负载（Load Average）
- 上下文切换次数

### 内存指标
- 使用率（%）
- 可用内存
- 交换分区使用

### 磁盘指标
- 使用率（%）
- IO等待时间
- 读写速度

### 网络指标
- 带宽使用
- 连接数
- 丢包率

## 监控工具

### Prometheus + Grafana（推荐）

架构：Node Exporter → Prometheus → Grafana

```yaml
# docker-compose.yml
version: '3'
services:
  prometheus:
    image: prom/prometheus
    volumes:
      - ./prometheus.yml:/etc/prometheus/prometheus.yml
    ports:
      - "9090:9090"
  
  grafana:
    image: grafana/grafana
    ports:
      - "3000:3000"
  
  node-exporter:
    image: prom/node-exporter
    ports:
      - "9100:9100"
```

### 传统工具

- **top/htop**：实时查看进程
- **vmstat**：虚拟内存统计
- **iostat**：IO统计
- **netstat**：网络连接

## 告警配置

```yaml
# alertmanager配置
route:
  receiver: 'dingtalk'
  
receivers:
  - name: 'dingtalk'
    webhook_configs:
      - url: 'https://oapi.dingtalk.com/robot/send?access_token=xxx'
```

## 仪表盘模板

推荐使用Grafana官方模板：
- Node Exporter Full (ID: 1860)
- 提供CPU、内存、磁盘、网络全面监控
