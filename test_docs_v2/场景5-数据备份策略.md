# 数据备份策略

## 概述

良好的备份策略是数据安全的基础。本文档定义公司的数据备份规范。

## 备份类型

### 完整备份
- 频率：每周日凌晨2点
- 保留期：4周
- 存储位置：异地机房

### 增量备份
- 频率：每日凌晨3点
- 保留期：7天
- 存储位置：本地 + 云存储

### 实时备份（WAL/Binlog）
- 频率：实时
- 保留期：7天
- 用途：支持时间点恢复

## 备份脚本

```bash
#!/bin/bash
# PostgreSQL 每日备份脚本

DATE=$(date +%Y%m%d)
BACKUP_DIR="/backup/postgres"

pg_dump -h localhost -U postgres -Fc mydb > $BACKUP_DIR/mydb_$DATE.dump

# 上传到云存储
aws s3 cp $BACKUP_DIR/mydb_$DATE.dump s3://company-backup/postgres/

# 删除7天前的本地备份
find $BACKUP_DIR -name "*.dump" -mtime +7 -delete
```

## 备份验证

每月进行一次备份恢复演练：
1. 选择一个备份文件
2. 在测试环境恢复
3. 验证数据完整性
4. 记录恢复时间

## 责任人

- DBA团队负责数据库备份
- 运维团队负责存储管理
- 安全团队负责备份加密
